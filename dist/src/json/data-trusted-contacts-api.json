{"openapi":"3.0.3","info":{"title":"Trusted Contacts","description":"Trusted Contacts","version":"1.0.0"},"servers":[{"url":"https"}],"tags":[{"name":"contacts"}],"paths":{"/contacts":{"parameters":[{"$ref":"#/components/parameters/X-Customer-Id"}],"get":{"tags":["contacts"],"description":"Search all users contacts","parameters":[{"in":"query","name":"is_trusted","required":false,"description":"Filter contacts with is_trusted=true/false","schema":{"type":"boolean"}},{"$ref":"#/components/parameters/limit"},{"$ref":"#/components/parameters/offset"}],"operationId":"searchContacts","summary":"Search contacts","responses":{"200":{"description":"Ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ContactsSearchResponse"},"examples":{"Result with new contacts":{"$ref":"#/components/examples/200-SearchContact-WithNewContacts"},"Result without contacts":{"$ref":"#/components/examples/200-SearchContact-WithoutContacts"}}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"},"examples":{"X-Customer-Id empty":{"$ref":"#/components/examples/400-EmptyCustomerId"},"X-Customer-Id bad":{"$ref":"#/components/examples/400-BadCustomerId"},"is_trusted bad":{"$ref":"#/components/examples/400-BadTrusted"},"limit bad":{"$ref":"#/components/examples/400-BadLimit"},"offset bad":{"$ref":"#/components/examples/400-BadOffset"}}}}},"404":{"description":"Not Found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"},"examples":{"X-Customer-Id not found":{"$ref":"#/components/examples/404-Query-No-Result"}}}}}}},"post":{"operationId":"createContact","tags":["contacts"],"summary":"Create a trusted contact","description":"Create a trusted contact","requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ContactRequest"}}}},"responses":{"201":{"description":"Created","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ContactResponse"}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"},"examples":{"X-Customer-Id empty":{"$ref":"#/components/examples/400-EmptyCustomerId"},"X-Customer-Id bad":{"$ref":"#/components/examples/400-BadCustomerId"},"user_identifier bad":{"$ref":"#/components/examples/400-BadUserIdentifier"},"alias bad":{"$ref":"#/components/examples/400-BadAlias"}}}}},"409":{"description":"Bad Request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"},"examples":{"User Identifier Duplicated":{"$ref":"#/components/examples/409-ContactUserIdentificationDuplicated"},"Alias Duplicated":{"$ref":"#/components/examples/409-ContactAliasDuplicated"}}}}}}}},"/contacts/{contact_id}":{"parameters":[{"$ref":"#/components/parameters/X-Customer-Id"},{"$ref":"#/components/parameters/contact_id"}],"put":{"tags":["contacts"],"operationId":"putContact","summary":"Update a contact","description":"Update only the fields that are in the body.","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateContactRequest"}}}},"responses":{"200":{"description":"Ok","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ContactResponse"}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"},"examples":{"X-Customer-Id empty":{"$ref":"#/components/examples/400-EmptyCustomerId"},"X-Customer-Id bad":{"$ref":"#/components/examples/400-BadCustomerId"}}}}},"403":{"description":"Forbidden","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"},"examples":{"X-Customer-Id not match with contact X-Customer-Id":{"$ref":"#/components/examples/403-Unauthorized-update"}}}}},"404":{"description":"Not Found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"},"examples":{"Contact Not Found":{"$ref":"#/components/examples/404-Contact-NotFound"}}}}},"409":{"description":"Bad Request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"},"examples":{"Alias Duplicated":{"$ref":"#/components/examples/409-ContactAliasDuplicated"}}}}}}},"delete":{"tags":["contacts"],"operationId":"deleteContact","summary":"Delete a contact","description":"Delete a contact","responses":{"204":{"description":"No Content"},"400":{"$ref":"#/components/responses/400"},"403":{"description":"Forbidden","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"},"examples":{"X-Customer-Id not match with contact X-Customer-Id":{"$ref":"#/components/examples/403-Unauthorized-update"}}}}},"404":{"description":"Not Found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"},"examples":{"When Contact Not Found":{"$ref":"#/components/examples/404-Contact-NotFound"}}}}}}}},"/contact/{user_identifier}":{"parameters":[{"$ref":"#/components/parameters/X-Customer-Id"},{"$ref":"#/components/parameters/user_identifier"},{"$ref":"#/components/parameters/X-Identifier-Type"}],"get":{"tags":["contacts"],"operationId":"findContactByUserIdentifier","summary":"Get if contact is trusted by user identifier","description":"Find if a contact is trusted by user identifier","responses":{"200":{"description":"Ok","content":{"application/json":{"schema":{"type":"object","properties":{"is_trusted":{"type":"boolean","description":"Indicates if the contact is already secure."}}}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"},"examples":{"X-Customer-Id empty":{"$ref":"#/components/examples/400-EmptyCustomerId"},"X-Customer-Id bad":{"$ref":"#/components/examples/400-BadCustomerId"}}}}},"404":{"description":"Not Found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"},"examples":{"When Contact Not Found":{"$ref":"#/components/examples/404-Contact-NotFound"}}}}}}}}},"components":{"parameters":{"X-Customer-Id":{"in":"query","name":"X-Customer-Id","description":"Owner user id.","required":true,"schema":{"type":"integer"}},"X-Identifier-Type":{"in":"query","name":"X-Identifier-Type","description":"Document type used as identifier.","required":true,"schema":{"type":"string","enum":["cpf","cnpj"]}},"contact_id":{"in":"path","name":"contact_id","description":"Contact ID","schema":{"type":"string"},"required":true},"user_identifier":{"in":"path","name":"user_identifier","description":"CPF/CNPJ","schema":{"type":"string"},"required":true},"limit":{"in":"query","name":"limit","description":"Limit of records per page. Default value 50.","schema":{"type":"integer"},"example":50},"offset":{"in":"query","name":"offset","description":"Offset. Default value 0.","schema":{"type":"integer"},"example":0}},"schemas":{"ContactRequest":{"required":["user_identifier","alias","identifier_type"],"type":"object","properties":{"user_identifier":{"type":"string","description":"Document ID used to identify the person."},"alias":{"type":"string","description":"Contact aliases"},"identifier_type":{"type":"string","description":"Type of document used as user_identifier (cpf/cnpj)","enum":["cpf","cnpj"]}}},"UpdateContactRequest":{"type":"object","properties":{"alias":{"type":"string","description":"Contact aliases"},"is_trusted":{"type":"boolean","description":"Indicates if the contact is already secure."}}},"ErrorResponse":{"type":"object","properties":{"error_code":{"type":"string"},"message":{"type":"string"},"status":{"type":"string"}}},"ContactsSearchResponse":{"type":"object","properties":{"paging":{"$ref":"#/components/schemas/Paging"},"results":{"type":"array","items":{"$ref":"#/components/schemas/ContactResponse"}}}},"ContactResponse":{"type":"object","properties":{"id":{"type":"string","format":"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx","description":"UUID of contact."},"alias":{"type":"string","description":"Contact aliases."},"status":{"type":"string","description":"Indicates the status of the contact, status: pending/ready."},"identifier_type":{"type":"string","description":"Type of document used as identifier","enum":["cpf","cnpj"]},"is_trusted":{"type":"boolean","description":"Indicates if the contact is already secure."},"trusted_updated_at":{"type":"string","format":"2022-04-27T17:13:00.489Z","description":"Date and time the contact was secured."},"created_at":{"type":"string","format":"2022-04-27T17:13:00.489Z","description":"Date and time the contact was created."},"updated_at":{"type":"string","format":"2022-04-27T17:13:00.489Z","description":"Date and time of the last modification."}}},"Paging":{"type":"object","properties":{"limit":{"type":"integer","description":"Limit of records per page."},"offset":{"type":"integer","description":"offset"},"total":{"type":"integer","description":"Total results found."}}}},"responses":{"400":{"description":"Bad Request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"},"examples":{"Empty Customer Id":{"$ref":"#/components/examples/400-EmptyCustomerId"},"Bad Trusted":{"$ref":"#/components/examples/400-BadTrusted"},"Bad Limit":{"$ref":"#/components/examples/400-BadLimit"},"Bad Offset":{"$ref":"#/components/examples/400-BadOffset"}}}}},"404":{"description":"Not Found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"},"examples":{"Empty Customer Id":{"$ref":"#/components/examples/400-EmptyCustomerId"}}}}}},"examples":{"200-SearchContact-WithNewContacts":{"description":"Result with new contacts","value":{"paging":{"limit":50,"offset":0,"total":3},"results":[{"id":"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx","alias":"alias-test","status":"ready","is_trusted":true,"trusted_updated_at":"2022-04-27T17:13:00.000Z","created_at":"2022-04-27T17:13:00.000Z","updated_at":"2022-04-28T17:14:00.000Z"},{"id":"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx","alias":"alias-test-02","status":"pending","is_trusted":false,"trusted_updated_at":"2022-04-27T17:13:00.000Z","created_at":"2022-04-27T17:15:00.000Z","updated_at":"2022-04-27T17:15:50.000Z"}]}},"200-SearchContact-WithoutContacts":{"description":"Result with new contacts","value":{"paging":{"limit":50,"offset":0,"total":0},"results":[]}},"409-ContactAliasDuplicated":{"description":"Contact duplicated","value":{"error_code":"alias_duplicated","message":"a contact with that alias already exists","status":"conflict"}},"409-ContactUserIdentificationDuplicated":{"description":"Contact duplicated","value":{"error_code":"unique_identifier_duplicated","message":"a contact with that user_identifier already exists","status":"conflict"}},"400-EmptyCustomerId":{"description":"Empty Field","value":{"error_code":"parse_error","message":"X-Customer-Id is required","status":"bad_request"}},"400-BadCustomerId":{"description":"Empty Field","value":{"error_code":"parse_error","message":"invalid X-Customer-Id {string}","status":"bad_request"}},"400-BadUserIdentifier":{"description":"Empty Field","value":{"error_code":"parse_error","message":"unprocessable_entity: validation_error: invalid fields: UserIdentifier","status":"bad_request"}},"400-BadAlias":{"description":"Empty Field","value":{"error_code":"parse_error","message":"unprocessable_entity: validation_error: invalid fields: Alias","status":"bad_request"}},"400-BadTrusted":{"description":"Parse error","value":{"error_code":"parse_error","message":"is_trusted type not valid","status":"bad_request"}},"400-BadLimit":{"description":"Parse error","value":{"error_code":"parse_error","message":"limit type not valid","status":"bad_request"}},"400-BadOffset":{"description":"Parse error","value":{"error_code":"parse_error","message":"offset type not valid","status":"bad_request"}},"404-Contact-NotFound":{"description":"Contact not found","value":{"error_code":"not_found","message":"query returned no results","status":"not_found"}},"404-Query-No-Result":{"description":"query returned no results","value":{"error_code":"not_found","message":"query returned no results","status":"not_found"}},"403-Unauthorized-update":{"description":"Unauthorized","value":{"error_code":"forbidden","message":"invalid permissions for this resource","status":"forbidden"}}}}}